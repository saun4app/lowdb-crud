<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lowdb-crud.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lowdb-crud.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as lodash from 'lodash'
import * as path from 'path'

import { LowdbCrudHelper } from './lowdb-crud-helper.js'

/**
 * @description
 * LowdbCrud provides create, read, update, delete (CRUD)
 * operations on a json data structure that resembles a database table.
 * LowdbCrud has 7 methods: &lt;code style='color:blue'>create()&lt;/code>, &lt;code style='color:blue'>read()&lt;/code>, &lt;code style='color:blue'>update()&lt;/code>, &lt;code style='color:blue'>upsert()&lt;/code>, &lt;code style='color:blue'>delete()&lt;/code>, &lt;code style='color:blue'>list_table()&lt;/code>, and &lt;code style='color:blue'>delete_table()&lt;/code>.
 * LowdbCrud is a wrapper of &lt;a href='https://github.com/typicode/lowdb' target='_blank'>lowdb&lt;/a> that stores all data in one json file that can represent multiple tables.
 * LowdbCrud uses a &lt;span style='color:blue'>data object&lt;/span>
 * that stores all data (tables). Each &lt;span style='color:blue'>key&lt;/span> of the object represents a table name.
 * The data of each table is stored in an &lt;span style='color:blue'>array of objects&lt;/span>.
 * The &lt;span style='color:blue'>table data structure&lt;/span> example below shows the data structure of 2 tables (&lt;span style='color:blue'>person&lt;/span> and &lt;span style='color:blue'>phone&lt;/span>).
 * Additionally, the &lt;span style='color:blue'>database object&lt;/span>, &lt;span style='color:blue'>data object&lt;/span>, and the &lt;span style='color:blue'>table object&lt;/span> (see syntax example bellow) can be manipulated directly by using &lt;a href='https://github.com/typicode/lowdb' target='_blank'>lowdb&lt;/a> and &lt;a href='https://github.com/lodash/lodash' target='_blank'>lodash&lt;/a>.
 * In terms of testing, &lt;a href='https://github.com/jasmine/jasmine-npm' target='_blank'>jasmine&lt;/a> can be used by default.  Other test frameworks may need additional configuration because &lt;a href='https://github.com/typicode/lowdb' target='_blank'>lowdb 3&lt;/a> is a pure ESM package.
 *
 * @example
 *   Table data structure:
 *
 *     {
 *       "person":[{"name":"Alexa", "age": 35},
 *                 {"name":"Drew", "age": 21}],
 *       "phone":[{"home":"234-567-8901", "cell":"234-567-8900"},
 *                "home":"234-789-8901", "cell":"234-789-8900"]
 *      }
 *
 * @example
 *   Object instantiation:
 *
 *       const param_obj = {'db_file':'/home/my-app/data.json'}
 *       const my_obj = new LowdbCrud(param_obj)
 *
 *   The database object:
 *       my_obj.attr.db_obj
 *
 *   The data object
 *       my_obj.attr.db_obj.data
 *
 *   The tables:
 *       my_obj.attr.db_obj.data['person']
 *       my_obj.attr.db_obj.data['phone']
 *
 * @param {Object} param_obj - {'db_file': 'full_path'}
 *
 */
class LowdbCrud {
  constructor(param_obj = {}) {
    LowdbCrudHelper.init_attr(this, param_obj)
    LowdbCrudHelper.init_db(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>create()&lt;/code> method inserts one or more rows of object into a table.
   * This method returns an &lt;code style='color:blue'>array&lt;/code> of &lt;code style='color:blue'>uuid&lt;/code> automatically created for each inserted row.
   *
   * @example
   *
   *   const person_obj_list = [{"name":"Alexa", "age": 35},
   *                        {"name":"Drew", "age": 21}]
   *
   *   const param_obj = {'table_name': 'person',
   *                      'row_obj_list': person_obj_list}
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const uuid_list = my_obj.create(param_obj)
   *   // Note: uuid_list looks like ["vXJUGH55tNo2iP91eUYLpk", "siysrj3q2PWn8EFX7rP5SL"}]
   *
   * @param {Object} param_obj - {'table_name': 'string',
   *                              'row_obj_list': array}
   *
   * @return {array} An uuid array of created rows.
   */
  create(param_obj = {}) {
    return LowdbCrudHelper.create_multi(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>read()&lt;/code> method retrieves one or more rows of object from a table.
   * This method returns an &lt;code style='color:blue'>array&lt;/code> of &lt;code style='color:blue'>row objects&lt;/code> based on &lt;code style='color:blue'>value_filter_obj&lt;/code> and &lt;code style='color:blue'>col_select_list&lt;/code> parameters.
   * if &lt;code style='color:blue'>value_filter_obj&lt;/code> is not given, all rows of the table are retrieved.
   * if &lt;code style='color:blue'>col_select_list&lt;/code> is not given, all columns of each row is retrieved.
   *
   * @example
   *
   *   const param_obj = {'table_name': 'person',
   *                      'value_filter_obj': { 'age': 21 },
   *                      'col_select_list': ['name']}
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const row_obj_list = my_obj.read(param_obj)
   *   // Note: row_obj_list is [{"name":"Drew"}]
   *
   * @param {object} param_obj - {'table_name': 'string',
   *                              'value_filter_obj': object}
   *                              'col_select_list': array}
   *
   * @return {array} An row object array that looks like
   *                 [{"name":"Drew", "age": 21}].
   */
  read(param_obj = {}) {
    return LowdbCrudHelper.read_multi(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>update()&lt;/code> method changes the value(s) of selected row(s), base on &lt;code style='color:blue'>value_filter_obj&lt;/code>, to the values of the &lt;code style='color:blue'>update_obj&lt;/code> parameter.
   * This method returns an &lt;code style='color:blue'>array&lt;/code> of &lt;code style='color:blue'>uuid&lt;/code> of the updated row(s).
   *
   * @example
   *
   *   const param_obj = {'table_name': 'person',
   *                      'value_filter_obj': { 'name': Drew },
   *                      'update_obj': { 'name': 'Andrew' }}
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const uuid_list = my_obj.update(param_obj)
   *   // Note: uuid_list looks like ["vXJUGH55tNo2iP91eUYLpk"}]
   *
   * @param {Object} param_obj - {'table_name': 'string',
   *                              'row_obj_list': array}
   *
   * @return {array} An uuid array of updated rows.
   */
  update(param_obj = {}) {
    param_obj['update_method'] = 'update_one'
    return LowdbCrudHelper.update_multi(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>upsert()&lt;/code> method calls &lt;code style='color:blue'>update()&lt;/code> method.
   * If the target row is not found, it calls &lt;code style='color:blue'>create()&lt;/code> method inserting the values of &lt;code style='color:blue'>update_obj&lt;/code> parameter as a new row.
   * This method returns an &lt;code style='color:blue'>array&lt;/code> of &lt;code style='color:blue'>uuid&lt;/code> of the &lt;span style='color:blue'>updated&lt;/span> or &lt;span style='color:blue'>inserted&lt;/span> row(s).
   *
   * @example
   *
   *   const param_obj = {'table_name': 'person',
   *                      'value_filter_obj': { 'name': Drew },
   *                      'update_obj': { 'name': 'Andrew' }}
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const uuid_list = my_obj.upsert(param_obj)
   *   // Note: uuid_list looks like ["vXJUGH55tNo2iP91eUYLpk"}]
   *
   * @param {Object} param_obj - {'table_name': 'string',
   *                              'row_obj_list': array}
   *
   * @return {array} An uuid array of updated or inserted rows.
   */
  upsert(param_obj = {}) {
    return LowdbCrudHelper.upsert_multi(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>delete()&lt;/code> method removes selected row(s) from a table base on &lt;code style='color:blue'>value_filter_obj&lt;/code> parameter.
   * This method returns an &lt;code style='color:blue'>array&lt;/code> of &lt;code style='color:blue'>uuid&lt;/code> of the deleted row(s).
   * If the &lt;code style='color:blue'>value_filter_obj&lt;/code> parameter is &lt;span style='color:red'>not given&lt;/span> or &lt;span style='color:red'>empty&lt;/span>, &lt;span style='color:red'>all rows&lt;/span> of the table will be &lt;span style='color:red'>deleted&lt;/span>.
   *
   * @example
   *
   *   const param_obj = {'table_name': 'person',
   *                    'value_filter_obj': { 'name': Drew }}
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const uuid_list = my_obj.delete(param_obj)
   *   // Note: uuid_list looks like ["vXJUGH55tNo2iP91eUYLpk"}]
   *
   * @param {Object} param_obj - {'table_name': 'string',
   *                              'value_filter_obj': array}
   *
   * @return {array} An uuid array of deleted rows.
   */
  delete(param_obj = {}) {
    return LowdbCrudHelper.delete_multi(this, param_obj)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>list_table()&lt;/code> returns an array of exiting table names.
   *
   * @example
   *
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const uuid_list = my_obj.list_table()
   *   // Note: table names looks like ["person", "address"]
   *
   *
   * @return {array} An array table names.
   */
  list_table(param_obj = {}) {
    return Object.keys(this.attr.db_obj.data)
  }

  /**
   * @description
   * The &lt;code style='color:blue'>delete_table()&lt;/code> method removes selected table from the data object base on &lt;code style='color:blue'>table_name&lt;/code> parameter.
   * This method returns the deleted &lt;code style='color:blue'>table_name&lt;/code> or null if the table name does not exist.
   *
   * @example
   *   const param_obj = {'table_name': 'person'}
   *   const my_obj = new LowdbCrud({'db_file':'/home/my-app/data.json'})
   *   const table_name = my_obj.delete(param_obj)
   *   // Note: table_name is 'person'
   *
   * @param {Object} param_obj - {'table_name': 'string'}
   *
   * @return {string} The deleted table name.
   */
  delete_table(param_obj = {}) {
    return LowdbCrudHelper.delete_table(this, param_obj)
  }
}

export { LowdbCrud }

/*
import { LowdbCrud } from './lowdb-crud.js'
*/
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="LowdbCrud.html">LowdbCrud</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue Feb 01 2022 21:54:29 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
